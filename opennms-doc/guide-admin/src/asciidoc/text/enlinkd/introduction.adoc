
// Allow GitHub image rendering
:imagesdir: ../../images

[[ga-enlinkd]]
== Enhanced Linkd

_Enhanced Linkd (Enlinkd)_ has been designed to discover connections between nodes from several protocols provided through SNMP agents.
_Enlinkd_ gathers this data in a regular interval and gets a snapshot of the neighbors from the device perspective.
The connections discovered by _Enlinkd_ are called _Links_.
The term _Link_ in context of _Enlinkd_ is not used in the same manner as in the network _Layer 2_ domain, where a link describes only a _Layer 2_ connection.
A _Link_ in context of _Enlinkd_ is a high level concept and can describes any kind of connection between two _OpenNMS Nodes_.
These _Links_ can be discovered based on information from example _Layer 2_, _Layer 3_ or other applications.

The coming sections describe the _Enlinkd_ daemon and his configuration.
Additionally the supported _Link discovery_ implementations will be described and which SNMP OIDs which have to be supported to gather _Links_ between _Nodes_.
Detailed information about discovered _Links_ and supported data can be seen on the _Node detail page_ in _OpenNMS_.

[[ga-enlinkd-daemon]]
=== Enlinkd Daemon

Essentially it asks each device the following question: "What is the network topology from your point of view".
From this point of view this will only provide local topology discovery features.
It does not attempt to discover global topology or doing any correlation with the data coming from other nodes.

For large environments the behavior of _Enlinkd_ can be configured.
During the _Link_ discovery process informational and error output is logged to a global log file.

.Global log and configuration files for _Enlinkd_
[options="header, autowidth"]
|===
| File                        | Location            | Description
| `enlinkd-configuration.xml` | `$OPENNMS_HOME/etc` | Global configuration for the daemon process
| `enlinkd.log`               | `$OPENNMS_HOME/log` | Global _Enlinkd_ log file
| `log4j2.xml`                | `$OPENNMS_HOME/etc` | Configuration file to set the log level for _Enlinkd_
|===

.Configuration file for _Enlinkd_
[source, xml]
----
<?xml version="1.0" encoding="ISO-8859-1"?>
<enlinkd-configuration threads="5"
                     initial_sleep_time="60000"
                     rescan_interval="86400000"
                     use-cdp-discovery="true"
                     use-bridge-discovery="true"
                     use-lldp-discovery="true"
                     use-ospf-discovery="true"
                     use-isis-discovery="true"
                     />
----

.Descriptione for global configuration parameter
[options="header, autowidth"]
|===
| Attribute              | Type      | Default    | Description
| `threads`              | _Integer_ | `5`        | Number of parallel threads used to discover the topology.
| `initial_sleep_time`   | _Integer_ | `60000`    | Time in milliseconds to wait for discovering the topology after OpenNMS is started.
| `rescan_interval`      | _Integer_ | `86400000` | Interval to rediscover and update the topology in milliseconds.
| `use-cdp-discovery`    | _Boolean_ | `true`     | Enable or disable topology discovery based on _CDP_ information.
| `use-bridge-discovery` | _Boolean_ | `true`     | Enable or disable algorithm to discover the topology based on the _Bridge MIB_ information.
| `use-lldp-discovery`   | _Boolean_ | `true`     | Enable or disable topology discovery based on _LLDP_ information.
| `use-ospf-discovery`   | _Boolean_ | `true`     | Enable or disable topology discovery based on _OSPF_ information.
| `use-isis-discovery`   | _Boolean_ | `true`     | Enable or disable topology discovery based on _IS-IS_ information.
|===

NOTE: If multiple protocols are enabled, the links will be discovered for each enabled discovery protocol.
      The topology WebUI will visualize _Links_ for each discovery protocol.
      For example if you start _CDP_ and _LLDP_ discovery, the WebUI will visualize a _CDP Link_ and a _LLDP Link_.
